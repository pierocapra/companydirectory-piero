"use strict";let currentPersonID="",depSlided=!0,locSlided=!1;function myFunction(e){e.matches&&(depSlided=!1)}let x=window.matchMedia("(max-width: 51.25em)");myFunction(x),x.addListener(myFunction),$(document).ready((function(){$(window).on("load",(function(){$("#preloader").length&&$("#preloader").delay(100).fadeOut("slow",(function(){$(this).remove()}))}));const e=function(){$.ajax({url:"libs/php/getAllDepartments.php",type:"GET",success:function(e){if("ok"==e.status.name){const t=e.data;$("#depList").html(""),$("#addDep").html(""),$("#editDep").html(""),$("#deleteDep").html(""),$.each(t,e=>{const a=t[e].name,n=t[e].id;$("#depList").append(`<li class="deploc-cell depCell-${n}"}>\n              <h3 class="deploc-name">${a}</h3>\n            </li>`),$("#addDep").append(`<option value="${n}">${a}</option>`),$("#editDep").append(`<option value="${n}">${a}</option>`),$("#deleteDep").append(`<option value="${n}">${a}</option>`),$(".depCell-"+n).on("click",()=>{$("#selectionResearch").html("department: "+a),$(".selection-par").css("backgroundColor","var(--secondary-color)"),$(".label-agenda").css("width","45px"),o(n),$("#searchInput").val(""),$("#depSection").css("transform","translateX(-110%)"),$("#btnDep").css("width","45px"),depSlided=!1})})}},error:function(e,t,a){$("#alertMessage").html("Error! Cannot retrieve departments!"),UIkit.modal("#alertModal").show()}})},t=function(){$.ajax({url:"libs/php/getAllLocations.php",type:"GET",success:function(e){if("ok"==e.status.name){const t=e.data;$("#locList").html(""),$("#addLoc").html(""),$("#deleteLoc").html(""),$.each(t,e=>{const a=t[e].name,o=t[e].id;$("#locList").append(`<li class="deploc-cell locCell-${o}"}>\n              <h3 class="deploc-name">${a}</h3>\n            </li>`),$("#addLoc").append(`<option value="${o}">${a}</option>`),$("#deleteLoc").append(`<option value="${o}">${a}</option>`),$(".locCell-"+o).on("click",()=>{$("#selectionResearch").html("location: "+a),$(".selection-par").css("backgroundColor","var(--tertiary-color)"),$(".label-agenda").css("width","45px"),n(o),$("#searchInput").val(""),$("#locSection").css("transform","translateX(-110%)"),$("#btnLoc").css("width","45px"),locSlided=!1})})}},error:function(e,t,a){$("#alertMessage").html("Error! Cannot retrieve locations!"),UIkit.modal("#alertModal").show()}})},a=function(){$.ajax({url:"libs/php/getAll.php",type:"GET",success:function(e){if("ok"==e.status.name){const t=e.data;l(t)}},error:function(e,t,a){$("#alertMessage").html("Error! Cannot retrieve Personnel!"),UIkit.modal("#alertModal").show()}})},o=function(e){$.ajax({url:"libs/php/getAllByDep.php",type:"POST",data:{depId:e},success:function(e){if("ok"==e.status.name){const t=e.data;l(t)}},error:function(e,t,a){$("#alertMessage").html("Error! Cannot retrieve Personnel by Department!"),UIkit.modal("#alertModal").show()}})},n=function(e){$.ajax({url:"libs/php/getAllByLoc.php",type:"POST",data:{locId:e},success:function(e){if("ok"==e.status.name){const t=e.data;l(t)}},error:function(e,t,a){$("#alertMessage").html("Error! Cannot retrieve Personnel by Location!"),UIkit.modal("#alertModal").show()}})},l=e=>{$(".names-container").html("");let t="";$.each(e,a=>{const o=e[a].lastName,n=e[a].firstName,l=e[a].email,i=e[a].id,s=e[a].jobTitle,r=e[a].depID,c=e[a].department,d=e[a].location,m=o[0].toUpperCase();m!=t&&($("#name-container").append(`</ul><div class="letter" >${m}</div><ul id="${m}">`),t=m),$("#name-container").append(`<li class="name-cell" id="person-${i}">\n            <h3 class="name">${o+", "+n}</h3><h4 class="inline-department">${c}</h4><h4 class="inline-location">${d}</h4>\n        </li>`),$("#person-"+i).on("click",()=>{"London"==d||"New York"==d||"Paris"==d||"Munich"==d||"Rome"===d?$("#cityImage").html(`<img\n          src="img/${d}.jpg"\n          alt="City Image"\n          class="city-image "\n        />`):$("#cityImage").html('<img\n          src="img/skyline-silhouette.jpg"\n          alt="City Image"\n          class="city-image "\n        />'),$("#infoName").html(n+" "+o),$("#email").html(l),$("#jobTitle").html(s),$("#department").html(c),$("#location").html(d),currentPersonID=i,$("#editfname").attr("placeholder",n),$("#editlname").attr("placeholder",o),$("#editemail").attr("placeholder",l),$("#editjob").attr("placeholder",s),$("#editDep").prepend(`<option value=${r} class="placeholder-look" selected>${c}</option>`),$("#secPersoninfo").css("transform","translateX(0)"),$("#depSection").css("transform","translateX(-110%)"),$("#btnDep").css("width","45px"),depSlided=!1,$("#locSection").css("transform","translateX(-110%)"),$("#btnLoc").css("width","45px"),locSlided=!1})})},i=t=>{$.ajax({url:"libs/php/checkDepartmentEmpty.php",type:"POST",data:{departmentID:t},success:function(a){0==a.data.COUNT?Confirm.open({message:"Are you sure you want to delete this Department?",onok:()=>{(t=>{$.ajax({url:"libs/php/deleteDepartment.php",type:"POST",data:{id:t},success:function(t){UIkit.notification({message:"DEPARTMENT SUCCESSFULLY DELETED!",status:"primary",pos:"top-right",timeout:4e3}),e(),UIkit.modal("#confirmDeleteDep").hide(),UIkit.dropdown("#deleteDepWindow").hide(0)},error:function(e,t,a){$("#alertMessage").html("Error in retrieving employees inside department"),UIkit.modal("#alertModal").show()}})})(t)}}):($("#alertMessage").html("This department contains employees!! It cannot be deleted!"),UIkit.modal("#alertModal").show())},error:function(e,t,a){$("#alertMessage").html("Error! Cannot delete the department from the database!"),UIkit.modal("#alertModal").show()}})},s=e=>{$.ajax({url:"libs/php/checkLocationEmpty.php",type:"POST",data:{locationID:e},success:function(a){0==a.data.COUNT?Confirm.open({message:"Are you sure you want to delete this location?",onok:()=>{(e=>{$.ajax({url:"libs/php/deleteLocation.php",type:"POST",data:{id:e},success:function(a){console.log(e),UIkit.notification({message:"LOCATION SUCCESSFULLY DELETED!",status:"primary",pos:"top-right",timeout:4e3}),t(),UIkit.modal("#confirmDeleteLoc").hide(),UIkit.dropdown("#deleteLocWindow").hide(0)},error:function(e,t,a){$("#alertMessage").html("Error in retrieving departments inside location"),UIkit.modal("#alertModal").show()}})})(e)}}):($("#alertMessage").html("This location contains departments and employees!! It cannot be deleted!"),UIkit.modal("#alertModal").show())},error:function(e,t,a){$("#alertMessage").html("Error! Cannot delete the location from the database!"),UIkit.modal("#alertModal").show()}})};a(),e(),t(),$("#searchInput").val(""),$("#editfname").val(""),$("#editlname").val(""),$("#editemail").val(""),$("#editjob").val(""),$("#editDep").val(""),$("#searchInput").keyup((function(){var e;e=$("#searchInput").val(),$.ajax({url:"libs/php/getAllBySearch.php",type:"POST",data:{substr:e},success:function(t){if("ok"==t.status.name){const a=t.data;$("#selectionResearch").html("personnel: "+e),$(".selection-par").css("backgroundColor","var(--primary-color)"),e||$("#selectionResearch").html("personnel: All"),l(a)}},error:function(e,t,a){$("#alertMessage").html("Error! Cannot retrieve Personnel by Search!"),UIkit.modal("#alertModal").show()}})})),$("#formAddEmployee").submit((function(e){var t,o,n,l,i;e.preventDefault(),t=$("#addfname").val(),o=$("#addlname").val(),n=$("#addemail").val(),l=$("#addjob").val(),i=$("#addDep").val(),$.ajax({url:"libs/php/insertPerson.php",type:"POST",data:{firstName:t,lastName:o,email:n,jobTitle:l,departmentID:i},success:function(e){let i=e.data.location;"London"==i||"New York"==i||"Paris"==i||"Munich"==i||"Rome"===i?$("#cityImage").html(`<img\n          src="img/${i}.jpg"\n          alt="City Image"\n          class="city-image "\n        />`):$("#cityImage").html('<img\n          src="img/skyline-silhouette.jpg"\n          alt="City Image"\n          class="city-image "\n        />'),$("#infoName").html(t+" "+o),$("#email").html(n),$("#jobTitle").html(l),$("#department").html(e.data.department),$("#location").html(i),UIkit.notification({message:"NEW EMPLOYEE SUCCESSFULLY ADDED!",status:"primary",pos:"top-right",timeout:4e3}),a()},error:function(e,t,a){$("#alertMessage").html("Error! Cannot Insert a new employee!"),UIkit.modal("#alertModal").show()}}),$("#addfname").val(""),$("#addlname").val(""),$("#addemail").val(""),$("#addjob").val(""),$("#addDep").val(""),UIkit.modal("#addEmployee").hide()})),$("#formAddDepartment").submit((function(t){var a,o;t.preventDefault(),a=$("#addNewDep").val(),o=$("#addLoc").val(),$.ajax({url:"libs/php/getAllDepartments.php",type:"GET",success:function(t){let n=!1;if("ok"==t.status.name){const e=t.data;$.each(e,t=>{e[t].name.toLowerCase()===a.trim().toLowerCase()&&(n=!0)})}!1===n?$.ajax({url:"libs/php/insertDepartment.php",type:"POST",data:{name:a.trim(),locationID:o},success:function(t){UIkit.notification({message:"NEW DEPARTMENT SUCCESSFULLY ADDED!",status:"primary",pos:"top-right",timeout:4e3}),e()},error:function(e,t,a){$("#alertMessage").html("Error! Cannot insert a new department!"),UIkit.modal("#alertModal").show()}}):($("#alertMessage").html("This department already exist!"),UIkit.modal("#alertModal").show())},error:function(e,t,a){$("#alertMessage").html("Error! Cannot insert a new department!"),UIkit.modal("#alertModal").show()}}),UIkit.dropdown("#addDepWindow").hide(0),$("#addNewDep").val(""),$("#addLoc").val("")})),$("#formAddLocation").submit((function(e){var a;e.preventDefault(),a=$("#addNewLoc").val(),$.ajax({url:"libs/php/getAllLocations.php",type:"GET",success:function(e){let o=!1;if("ok"==e.status.name){const t=e.data;$.each(t,e=>{t[e].name.toLowerCase()===a.trim().toLowerCase()&&(o=!0)})}!1===o?$.ajax({url:"libs/php/insertLocation.php",type:"POST",data:{name:a.trim()},success:function(e){UIkit.notification({message:"NEW LOCATION SUCCESSFULLY ADDED!",status:"primary",pos:"top-right",timeout:4e3}),t()},error:function(e,t,a){$("#alertMessage").html("Error! Cannot insert a new Location!"),UIkit.modal("#alertModal").show()}}):($("#alertMessage").html("This location already exist!"),UIkit.modal("#alertModal").show())},error:function(e,t,a){$("#alertMessage").html("Error! Cannot insert a new Location!"),UIkit.modal("#alertModal").show()}}),UIkit.dropdown("#addLocWindow").hide(0),$("#addNewLoc").val("")})),$("#formEditEmployee").submit((function(e){e.preventDefault();let t="",o="",n="",l="";t=""==$("#editfname").val()?$("#editfname").attr("placeholder"):$("#editfname").val(),o=""==$("#editlname").val()?$("#editlname").attr("placeholder"):$("#editlname").val(),n=""==$("#editemail").val()?$("#editemail").attr("placeholder"):$("#editemail").val(),l=""==$("#editjob").val()?$("#editjob").attr("placeholder"):$("#editjob").val(),((e,t,o,n,l,i)=>{$.ajax({url:"libs/php/editPerson.php",type:"POST",data:{firstName:e,lastName:t,email:o,jobTitle:n,departmentID:l,personID:i},success:function(e){const t=e.data,o=t.lastName,n=t.firstName,l=t.email,i=t.jobTitle,s=t.department,r=t.location;"London"==r||"New York"==r||"Paris"==r||"Munich"==r||"Rome"===r?$("#cityImage").html(`<img\n          src="img/${r}.jpg"\n          alt="City Image"\n          class="city-image "\n        />`):$("#cityImage").html('<img\n          src="img/skyline-silhouette.jpg"\n          alt="City Image"\n          class="city-image "\n        />'),$("#infoName").html(n+" "+o),$("#email").html(l),$("#jobTitle").html(i),$("#department").html(s),$("#location").html(r),UIkit.notification({message:"EMPLOYEE DETAILS SUCCESSFULLY EDITED!",status:"primary",pos:"top-right",timeout:4e3}),a()},error:function(e,t,a){$("#alertMessage").html("Error! Cannot edit this person!"),UIkit.modal("#alertModal").show()}})})(t,o,n,l,$("#editDep").val(),currentPersonID),$("#editfname").val(""),$("#editlname").val(""),$("#editemail").val(""),$("#editjob").val(""),$("#editDep").val(""),$("#editfname").attr("placeholder",t),$("#editlname").attr("placeholder",o),$("#editemail").attr("placeholder",n),$("#editjob").attr("placeholder",l),UIkit.modal("#editEmployee").hide()})),$("#deleteButton").on("click",()=>{Confirm.open({message:"Are you sure you want to delete this Employee?",onok:()=>{var e;e=currentPersonID,$.ajax({url:"libs/php/deletePerson.php",type:"POST",data:{id:e},success:function(e){UIkit.notification({message:"EMPLOYEE SUCCESSFULLY DELETED!",status:"primary",pos:"top-right",timeout:4e3}),$("#secPersoninfo").css("transform","translateX(100%)"),a()},error:function(e,t,a){$("#alertMessage").html("Error! Cannot delete this person!"),UIkit.modal("#alertModal").show()}}),$("#cityImage").html('<img\n        src="img/skyline-silhouette.jpg"\n        alt="City Image"\n        class="city-image "\n      />'),$("#infoName").html(""),$("#email").html(""),$("#jobTitle").html(""),$("#department").html(""),$("#location").html("")}})}),$("#deleteDepButton").on("click",()=>{i($("#deleteDep").val())}),$("#deleteLocButton").on("click",()=>{s($("#deleteLoc").val())}),$("#btnPersonnel").on("click",()=>{a(),$("#btnPersonnel").css("width","55px"),$("#depSection").css("transform","translateX(-110%)"),$("#locSection").css("transform","translateX(-110%)"),$("#btnDep").css("width","45px"),$("#btnLoc").css("width","45px"),locSlided=!1,depSlided=!1,$("#selectionResearch").html("personnel: All"),$(".selection-par").css("backgroundColor","var(--primary-color)"),$("#searchInput").val("")}),$("#btnDep").on("click",()=>{depSlided?($("#depSection").css("transform","translateX(-110%)"),$("#btnDep").css("width","45px"),depSlided=!1):(e(),$("#depSection").css("transform","translateX(0)"),$("#locSection").css("transform","translateX(-110%)"),$("#btnDep").css("width","55px"),$("#btnLoc").css("width","45px"),depSlided=!0,locSlided=!1)}),$("#btnLoc").on("click",()=>{locSlided?($("#locSection").css("transform","translateX(-110%)"),$("#btnLoc").css("width","45px"),locSlided=!1):(t(),$("#depSection").css("transform","translateX(-110%)"),$("#locSection").css("transform","translateX(0)"),$("#btnDep").css("width","45px"),$("#btnLoc").css("width","55px"),locSlided=!0,depSlided=!1)}),$("#closePersonInfo").on("click",()=>{$(".secPersonInfo").css("transform","translate(100%)")}),$("#closeAddDep").on("click",()=>{UIkit.dropdown("#addDepWindow").hide(0)}),$("#closeDelDep").on("click",()=>{UIkit.dropdown("#deleteDepWindow").hide(0)}),$("#closeAddLoc").on("click",()=>{UIkit.dropdown("#addLocWindow").hide(0)}),$("#closeDelLoc").on("click",()=>{UIkit.dropdown("#deleteLocWindow").hide(0)})}));const Confirm={open(e){const t=`\n      <div class="confirm">\n        <div class="confirm__window">\n        <img\n                src="vendors/icons/close-outline.svg"\n                alt="Close X"\n                class="uk-modal-close close-confirm"\n                id="closeConfirm"\n              />\n          <div class="confirm__content">\n            <img\n              src="vendors/icons/warning.svg"\n              alt="Warning Icon"\n              class="warning-icon" />\n            <p>${(e=Object.assign({},{title:"",message:"",cancelText:"Cancel",okText:"OK",onok:function(){},oncancel:function(){}},e)).message}</p>\n          </div>\n          <div class="confirm__buttons">\n            <button class="button confirm__button confirm__button--cancel">${e.cancelText}</button>\n            <button class="button confirm__button confirm__button--ok confirm__button--fill">${e.okText}</button>\n          </div>\n        </div>\n      </div>\n    `,a=document.createElement("template");a.innerHTML=t;const o=a.content.querySelector(".confirm"),n=a.content.querySelector(".confirm__button--ok"),l=a.content.querySelector("#closeConfirm"),i=a.content.querySelector(".confirm__button--cancel");o.addEventListener("click",t=>{t.target===o&&(e.oncancel(),this._close(o))}),n.addEventListener("click",()=>{e.onok(),this._close(o)}),l.addEventListener("click",()=>{e.oncancel(),this._close(o)}),i.addEventListener("click",()=>{e.oncancel(),this._close(o)}),document.body.appendChild(a.content)},_close(e){e.classList.add("confirm--close"),e.addEventListener("animationend",()=>{document.body.removeChild(e)})}};